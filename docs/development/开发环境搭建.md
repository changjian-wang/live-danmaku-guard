# 开发环境搭建

本文档提供详细的开发环境配置指南。

## 系统要求

### 硬件要求
- **CPU**: 双核以上处理器
- **内存**: 8GB RAM (推荐16GB)
- **硬盘**: 10GB可用空间
- **网络**: 稳定的互联网连接

### 操作系统
- Windows 10/11 (x64)
- macOS 11+
- Linux (Ubuntu 20.04+ / 其他主流发行版)

## 必需软件安装

### 1. .NET 8.0 SDK

**Windows:**
```powershell
# 使用 winget (Windows 11)
winget install Microsoft.DotNet.SDK.8

# 或访问官网下载
# https://dotnet.microsoft.com/download/dotnet/8.0
```

**macOS:**
```bash
# 使用 Homebrew
brew install --cask dotnet-sdk

# 或访问官网下载
```

**Linux:**
```bash
# Ubuntu/Debian
wget https://packages.microsoft.com/config/ubuntu/22.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
sudo dpkg -i packages-microsoft-prod.deb
sudo apt-get update
sudo apt-get install -y dotnet-sdk-8.0
```

**验证安装:**
```bash
dotnet --version
# 应输出: 8.0.x 或更高版本
```

### 2. Node.js 20+

**Windows:**
```powershell
# 使用 winget
winget install OpenJS.NodeJS.LTS

# 或访问官网下载
# https://nodejs.org/
```

**macOS:**
```bash
# 使用 Homebrew
brew install node@20

# 或使用 nvm (推荐)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 20
nvm use 20
```

**Linux:**
```bash
# 使用 nvm (推荐)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 20
nvm use 20

# 或使用包管理器
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs
```

**验证安装:**
```bash
node --version  # 应输出: v20.x.x
npm --version   # 应输出: 10.x.x
```

### 3. Git

**Windows:**
```powershell
winget install Git.Git
```

**macOS:**
```bash
brew install git
```

**Linux:**
```bash
sudo apt-get install git
```

**验证安装:**
```bash
git --version
```

## 开发工具

### IDE推荐

#### Visual Studio 2022 (Windows)

**安装工作负载:**
- ASP.NET和Web开发
- .NET桌面开发
- .NET Core跨平台开发

**推荐扩展:**
- ReSharper (可选，付费)
- GitHub Copilot

#### Visual Studio Code (跨平台)

**安装:**
```bash
# Windows
winget install Microsoft.VisualStudioCode

# macOS
brew install --cask visual-studio-code

# Linux
sudo snap install code --classic
```

**必需扩展:**
```bash
code --install-extension ms-dotnettools.csdevkit
code --install-extension Vue.volar
code --install-extension dbaeumer.vscode-eslint
code --install-extension esbenp.prettier-vscode
code --install-extension eamodio.gitlens
```

### 浏览器开发工具

**Chrome / Edge (推荐):**
- Vue.js devtools
- React Developer Tools

## 可选软件

### Docker Desktop

**用途**: 容器化部署和测试

**Windows/macOS:**
访问 https://www.docker.com/products/docker-desktop

**Linux:**
```bash
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
```

### Postman / Thunder Client

**用途**: API测试

**安装:**
- Postman: https://www.postman.com/downloads/
- Thunder Client: VS Code扩展

### DB Browser for SQLite

**用途**: SQLite数据库管理

**安装:**
访问 https://sqlitebrowser.org/

## 项目设置

### 1. 克隆项目

```bash
git clone https://github.com/changjian-wang/live-danmaku-guard.git
cd live-danmaku-guard
```

### 2. 后端设置

```bash
cd src/backend

# 恢复依赖
dotnet restore

# 构建项目
dotnet build

# 运行测试 (可选)
dotnet test

# 启动API
dotnet run --project LiveDanmakuGuard.Api
```

API将在 `http://localhost:5000` 启动。

### 3. 前端设置

```bash
cd src/frontend/live-danmaku-guard-web

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

前端将在 `http://localhost:5173` 启动。

## 环境变量配置

### 后端环境变量

创建 `src/backend/LiveDanmakuGuard.Api/.env` (可选):

```env
ASPNETCORE_ENVIRONMENT=Development
ASPNETCORE_URLS=http://localhost:5000
ConnectionStrings__DefaultConnection=Data Source=app.db
```

### 前端环境变量

创建 `src/frontend/live-danmaku-guard-web/.env.local`:

```env
VITE_API_BASE_URL=http://localhost:5000/api
```

## 常见问题

### 端口冲突

如果5000或5173端口已被占用:

**后端**: 修改 `launchSettings.json`
**前端**: 修改 `vite.config.ts` 中的 `server.port`

### SSL证书问题

```bash
# 信任开发证书
dotnet dev-certs https --trust
```

### 数据库迁移

```bash
cd src/backend
dotnet ef migrations add InitialCreate --project LiveDanmakuGuard.Data --startup-project LiveDanmakuGuard.Api
dotnet ef database update --project LiveDanmakuGuard.Data --startup-project LiveDanmakuGuard.Api
```

## 代码规范

### .NET代码规范

遵循 Microsoft C# 编码约定:
- https://docs.microsoft.com/en-us/dotnet/csharp/fundamentals/coding-style/coding-conventions

### TypeScript/Vue代码规范

遵循 Vue 3 风格指南:
- https://vuejs.org/style-guide/

### 提交规范

使用 Conventional Commits:
```
feat: 新功能
fix: 修复
docs: 文档
style: 格式
refactor: 重构
test: 测试
chore: 构建/工具
```

## 下一步

- 阅读 [快速开始](../guide/快速开始.md)
- 查看 [技术架构](../plan/02-技术架构.md)
- 参考 [API设计](../plan/05-API设计.md)

---

**最后更新**: 2026-01-04
